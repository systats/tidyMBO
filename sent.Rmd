---
title: "R Notebook"
output: html_notebook
---

```{r}
sent_dicts <- list(
    tidyTX::sent_afinn,
    tidyTX::sent_vader,
    tidyTX::sent_wordnet
  )

  sent_ind <- sent_dicts %>%
    purrr::reduce(dplyr::full_join, by = "word") %>%
    group_by(word) %>%
    slice(1) %>%
    ungroup() %>%
    mutate(word = word %>% stringr::str_replace("[[:punct:]]", "")) %>%
    select(word, contains("_score")) %>%
    mutate_if(is.numeric, scale)


  fun_average <- function(x){
    m <- mean(x, na.rm = T)
    n <- ifelse(is.nan(m), NA, m)
    return(n)
  }

  sent <- tokens %>%
    left_join(sent_ind, by = "word") %>%
    group_by(id) %>%
    select(contains("_score")) %>%
    summarise_if(is.double, fun_average) %>%
    ungroup()

  sent$sent_pool <- sent %>%
    select(contains("score")) %>%
    rowMeans(na.rm = T) %>%
    ifelse(is.nan(.), NA, .)
```

